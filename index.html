<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Object detection</title>
    <!--Github Source: https://github.com/tensorflow/tfjs-models/tree/master/coco-ssd -->

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="
https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2/dist/coco-ssd.min.js
"></script>

<style>
    #webcam, #canvas {
        width: 640px;
        height: 480px;
        position: absolute;
    }
</style>

</head>

<body>
   <canvas id="canvas"></canvas> 
   <video id="webcam" autoplay muted></video>

<script>

const video = document.getElementById('webcam');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let model;

async function startMyVideo() {

    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
    video.srcObject = stream;
    await video.play();
}

async function detectAndLog() {
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  const image = tf.browser.fromPixels(canvas);
  const predictions = await model.detect(image);
  try {
  if(predictions.length > 0 ){
    console.log(predictions.length);
  
    for (const prediction of predictions) {
      console.log(prediction.class);
    }
  }
  } 
  catch (err) {
    console.error('error: ', err);
  }
  
}
cocoSsd.load().then(loadedModel => {
  model = loadedModel;
  startMyVideo();
  setInterval(detectAndLog, 700);
});

</script>
</body>
</html>